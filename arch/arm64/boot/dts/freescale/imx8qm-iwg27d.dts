// SPDX-License-Identifier: GPL-2.0+
/*
 * Copyright (c) 2020 iWave Systems Technologies Pvt. Ltd.
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 */

/dts-v1/;

#include "imx8qm-iwg27m.dtsi"

/ {
	model = "iW-RainboW-G27D-i.MX8QM-Q7";
	compatible = "fsl,imx8qm-iwg27m", "fsl,imx8qm";

	clocks {
		#address-cells = <1>;
		#size-cells = <0>;

		audioclk: ext26Mz { /* SGTL5000: External Audio Clock */
			compatible = "fixed-clock";
			clock-frequency = <26000000>;
			reg=<0>;
			#clock-cells = <0>;
		};
	};

	unused_gpios: unused_gpios { /* GPIO: Setting Unused GPIOs as input pins */
		compatible = "iwave,unused-gpios";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_unused_gpio>;
		status = "okay";  
	};

	reg_1p5v: 1p5v { /* Regulator: Fixed 1.5V Regulator */
		compatible = "regulator-fixed";
		regulator-name = "1P5V";
		regulator-min-microvolt = <1500000>;
		regulator-max-microvolt = <1500000>;
		regulator-always-on;
	};

	reg_can0_stby: regulator-can-stby0 { /* CAN: CAN0 Standby Regulator */
		compatible = "regulator-fixed";
		regulator-name = "CAN0_STBY_1P8V";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		gpio = <&lsio_gpio1 8 GPIO_ACTIVE_HIGH>;
		regulator-always-on;
	};

	vcc5v0_usb: vcc5v0-usb {
		compatible = "regulator-fixed";
		regulator-name = "vcc5v0_usb";
		regulator-always-on;
		regulator-boot-on;
		regulator-min-microvolt = <5000000>;
		regulator-max-microvolt = <5000000>;
	};

	sound { /* SGTL5000: Audio Codec */
		compatible = "fsl,imx-audio-sgtl5000";
		model = "sgtl5000-audio";
		ssi-controller = <&sai1>;
		audio-codec = <&codec>;
		audio-routing = "MIC_IN", "Mic Jack",
				"Mic Jack", "Mic Bias",
				"Headphone Jack", "HP_OUT",
				"LINE_IN", "Line In Jack";
	};
	
	sound-hdmi-tx {
		status = "okay";
	};

	display-subsystem {
                compatible = "fsl,imx-display-subsystem";
		status = "okay";
                ports = <&dpu2_disp1>,<&dpu1_disp0>,<&dpu1_disp1>;
	};

        lvds1_panel {
                compatible = "edt,etm0700g0dh6";
                pinctrl-0 = <&pinctrl_lvds>;
		backlight = <&lvds1_backlight>;
		enable-gpios = <&lsio_gpio1 14 GPIO_ACTIVE_HIGH>;
		bklgt-gpios = <&lsio_gpio1 9 GPIO_ACTIVE_HIGH>;
		power-supply = <&reg_1p8v>;	
		status = "okay";
	                port {
                        panel_lvds1_in: endpoint {
                                remote-endpoint = <&lvds1_out>;
                        };
                };
		
           };

	lvds1_backlight: lvds1_backlight { /* LVDS1: LVDS Backlight Enable */
		compatible = "pwm-backlight";
		pwms = <&pwm_lvds1 0 100000 0>;
		power-supply = <&reg_1p8v>;
		brightness-levels = < 0  1  2  3  4  5  6  7  8  9
				     10 11 12 13 14 15 16 17 18 19
				     20 21 22 23 24 25 26 27 28 29
				     30 31 32 33 34 35 36 37 38 39
				     40 41 42 43 44 45 46 47 48 49
				     50 51 52 53 54 55 56 57 58 59
				     60 61 62 63 64 65 66 67 68 69
				     70 71 72 73 74 75 76 77 78 79
				     80 81 82 83 84 85 86 87 88 89
				     90 91 92 93 94 95 96 97 98 99
				    100>;
		default-brightness-level = <100>;
		status = "okay";
	};
};

&sai1 { /* SGTL5000: Serial Audio Interface for SGTL5000 Audio Codec */
	assigned-clocks = <&clk IMX_SC_R_AUDIO_PLL_0 IMX_SC_PM_CLK_PLL>,
		<&clk IMX_SC_R_AUDIO_PLL_0 IMX_SC_PM_CLK_SLV_BUS>,
		<&clk IMX_SC_R_AUDIO_PLL_0 IMX_SC_PM_CLK_MST_BUS>,
		<&sai1_lpcg 0>; /* FIXME: should be sai1, original code is 0 */
	assigned-clock-rates = <786432000>, <49152000>, <12288000>, <49152000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_sai1>;
	status = "okay";
};

&pwm_lvds1 {
        pinctrl-names = "default";
        pinctrl-0 = <&pinctrl_pwm_lvds1>;
        status = "okay";
};

&hdmi {
	status = "okay";
};

&irqsteer_hdmi{
        status = "okay";
};

&ldb2_phy { /* LVDS1: LVDS LDB Phy */
	status = "okay";
};

&irqsteer_lvds1 {
	status = "okay";
};

&ldb2 { /* LVDS1: LVDS Channel-0 Port Enable */
	status = "okay";

	lvds-channel@0 {
		fsl,data-mapping = "jeida";
		fsl,data-width = <24>;
		status = "okay";

		port@1 {
			reg = <1>;
			lvds1_out: endpoint {
		  		remote-endpoint = <&panel_lvds1_in>;
	   		};
		};	
	};

};

&lpspi3 { /* LPSPI3: SPI Flash Device */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_lpspi3>;
	cs-gpios = <&lsio_gpio2 20 GPIO_ACTIVE_LOW>;
	fsl,spi-num-chipselects = <1>;
	assigned-clock-rates = <80000000>;
	#address-cells = <1>;
	#size-cells = <0>;
	status = "okay";
		flash: m25p80@0 {
			#address-cells = <1>;
			#size-cells = <1>;
		        compatible = "microchip,sst25vf016b", "jedec,spi-nor";
		        spi-max-frequency = <40000000>;
			reg = <0>;
       		};

};

&lpuart0 { /* LPUART0: DATA UART */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_lpuart0>;
	dma-names = "tx","rx";
	power-domains = <&pd IMX_SC_R_UART_0>;
	dmas = <&edma2 13 0 0>,
	       <&edma2 12 0 1>;
	status = "okay";
};

&flexcan1 { /* CAN: FLEXCAN1 */
	xceiver-supply = <&reg_can0_stby>;
	status = "okay";
};

&i2c2 { /* I2C: LPI2C1 */
        #address-cells = <1>;
        #size-cells = <0>;
        pinctrl-names = "default";
        pinctrl-0 = <&pinctrl_lpi2c2>;
        clock-frequency = <400000>;
        status = "okay";

        codec: sgtl5000@a { /* SGTL5000: Audio Codec */
                compatible = "fsl,sgtl5000";
                reg = <0x0a>;
                clocks = <&audioclk 0>;
                VDDA-supply = <&reg_1p8v>;
                VDDIO-supply = <&reg_1p8v>;
                VDDD-supply = <&reg_1p5v>;
                power-domains = <&pd IMX_SC_R_MCLK_OUT_0>;
                status = "okay";
        };
	
       polytouch: edt-ft5x06@38 {
               compatible = "edt,edt-ft5406", "edt,edt-ft5x06";
               reg = <0x38>;
               pinctrl-names = "default";
               pinctrl-0 = <&pinctrl_touch>;
               interrupt-parent = <&lsio_gpio3>;
               interrupts = <12 IRQ_TYPE_EDGE_FALLING>;
               reset-gpios = <&lsio_gpio1 5 GPIO_ACTIVE_LOW>;
	       status = "okay";
       };

};

&iomuxc {

	imx8qm-iwg27m {
		pinctrl_lpspi3: lpspi3grp { /* LPSPI3: LPSPI3 IOMUX Pin Configuration */
			fsl,pins = <
				IMX8QM_SPI3_SCK_DMA_SPI3_SCK				0x0600004c
				IMX8QM_SPI3_SDO_DMA_SPI3_SDO				0x0600004c
				IMX8QM_SPI3_SDI_DMA_SPI3_SDI				0x0600004c
				IMX8QM_SPI3_CS0_LSIO_GPIO2_IO20				0x00000021
			>;
		};
		
                pinctrl_lvds: lvdsgrp { /* LVDS1: LVDS IOMUX Pin Configuration */
                        fsl,pins = <
				IMX8QM_LVDS1_I2C1_SCL_LSIO_GPIO1_IO14			0x00000021
				IMX8QM_LVDS0_I2C1_SDA_LSIO_GPIO1_IO09			0x00000021
                        >;
		};
	
		pinctrl_pwm_lvds1: pwmlvds1grp { /* LVDS1i PWM: LVDS PWM IOMUX Pin Configuration */
			 fsl,pins = <
				 IMX8QM_LVDS1_GPIO00_LVDS1_PWM0_OUT                       0x00000020
			 >;
	        };

                pinctrl_touch: touchgrp { /*Touch: Touch IOMUX Pin Configuration */
                        fsl,pins = <
                               	IMX8QM_LVDS0_GPIO01_LSIO_GPIO1_IO05                   0x00000021
                                IMX8QM_SAI1_RXC_LSIO_GPIO3_IO12                       0x00000021
                        >;
		};

		pinctrl_lpuart0: lpuart0grp { /* LPUART0: DATA UART IOMUX Pin Configuration */
			fsl,pins = <
				IMX8QM_UART0_RX_DMA_UART0_RX				0x06000020
				IMX8QM_UART0_TX_DMA_UART0_TX				0x06000020
				IMX8QM_UART0_RTS_B_DMA_UART0_RTS_B			0x06000020
				IMX8QM_UART0_CTS_B_DMA_UART0_CTS_B			0x06000020
			>;
		};

		pinctrl_sai1: sai1grp { /* SGTL5000: SAI Audio IOMUX Pin Configuration */
			fsl,pins = <
				IMX8QM_SAI1_RXD_AUD_SAI1_RXD				0xc600004c
				IMX8QM_SAI1_TXC_AUD_SAI1_TXC				0xc600004c
				IMX8QM_SAI1_TXD_AUD_SAI1_TXD				0xc600004c
				IMX8QM_SAI1_TXFS_AUD_SAI1_TXFS				0xc600004c
			>;
		};

		pinctrl_lpi2c2: lpi2c2grp { /* I2C1: IOMUX Pin Configuration */
			fsl,pins = <
				IMX8QM_GPT1_CLK_DMA_I2C2_SCL				0xc600004c
				IMX8QM_GPT1_CAPTURE_DMA_I2C2_SDA			0xc600004c
			>;
		};

		pinctrl_unused_gpio: unused_gpiogrp{ /* GPIO: Unused GPIOs IOMUX Pin Configuration */
			fsl,pins = <
				IMX8QM_MIPI_DSI0_I2C0_SDA_LSIO_GPIO1_IO17		0x00000021
				IMX8QM_MIPI_DSI0_I2C0_SCL_LSIO_GPIO1_IO16		0x00000021
				IMX8QM_FLEXCAN1_TX_LSIO_GPIO4_IO00			0x00000021
				IMX8QM_FLEXCAN1_RX_LSIO_GPIO3_IO31			0x00000021
				IMX8QM_FLEXCAN2_TX_LSIO_GPIO4_IO02			0x00000021
				IMX8QM_FLEXCAN2_RX_LSIO_GPIO4_IO01			0x00000021
				IMX8QM_ENET1_RGMII_TXC_LSIO_GPIO6_IO10			0x00000021
				IMX8QM_ENET1_RGMII_TX_CTL_LSIO_GPIO6_IO11		0x00000021
				IMX8QM_ENET1_RGMII_TXD0_LSIO_GPIO6_IO12			0x00000021
				IMX8QM_ENET1_RGMII_TXD1_LSIO_GPIO6_IO13			0x00000021
				IMX8QM_ENET1_RGMII_TXD2_DMA_UART3_TX			0x00000021
				IMX8QM_ENET1_RGMII_TXD3_LSIO_GPIO6_IO15			0x00000021
				IMX8QM_ENET1_RGMII_RXC_LSIO_GPIO6_IO16			0x00000021
				IMX8QM_ENET1_RGMII_RX_CTL_LSIO_GPIO6_IO17		0x00000021
				IMX8QM_ENET1_RGMII_RXD0_LSIO_GPIO6_IO18			0x00000021
				IMX8QM_ENET1_RGMII_RXD1_LSIO_GPIO6_IO19			0x00000021
				IMX8QM_ENET1_RGMII_RXD2_LSIO_GPIO6_IO20			0x00000021
				IMX8QM_ENET1_RGMII_RXD3_LSIO_GPIO6_IO21			0x00000021
				IMX8QM_ENET1_REFCLK_125M_25M_LSIO_GPIO4_IO16		0x00000021
				IMX8QM_ENET1_MDIO_LSIO_GPIO4_IO17			0x00000021
				IMX8QM_ENET1_MDC_LSIO_GPIO4_IO18			0x00000021
				IMX8QM_ADC_IN4_LSIO_GPIO3_IO22				0x00000021
				IMX8QM_ADC_IN5_LSIO_GPIO3_IO23				0x00000021
				IMX8QM_LVDS0_GPIO00_LSIO_GPIO1_IO04			0x00000021
				IMX8QM_MIPI_DSI1_I2C0_SCL_LSIO_GPIO1_IO20		0x00000021
				IMX8QM_MIPI_DSI1_I2C0_SDA_LSIO_GPIO1_IO21		0x00000021
				IMX8QM_M41_GPIO0_00_LSIO_GPIO0_IO12			0x00000021
				IMX8QM_M41_GPIO0_01_LSIO_GPIO0_IO13			0x00000021
				IMX8QM_LVDS0_I2C0_SDA_LSIO_GPIO1_IO07			0x00000021
				IMX8QM_LVDS0_I2C0_SCL_LSIO_GPIO1_IO06			0x00000021
				IMX8QM_QSPI1A_SS0_B_LSIO_GPIO4_IO19			0x00000021
				IMX8QM_QSPI1A_SS1_B_LSIO_GPIO4_IO20			0x00000021
				IMX8QM_QSPI1A_SCLK_LSIO_GPIO4_IO21			0x00000021
				IMX8QM_QSPI1A_DQS_LSIO_GPIO4_IO22			0x00000021
				IMX8QM_QSPI1A_DATA3_LSIO_GPIO4_IO23			0x00000021
				IMX8QM_QSPI1A_DATA2_LSIO_GPIO4_IO24			0x00000021
				IMX8QM_QSPI1A_DATA1_LSIO_GPIO4_IO25			0x00000021
				IMX8QM_QSPI1A_DATA0_LSIO_GPIO4_IO26			0x00000021
				IMX8QM_ESAI1_SCKR_LSIO_GPIO2_IO06			0x00000021
				IMX8QM_ESAI1_FSR_LSIO_GPIO2_IO04			0x00000021
				IMX8QM_ESAI1_TX0_LSIO_GPIO2_IO08			0x00000021
				IMX8QM_ESAI1_TX2_RX3_LSIO_GPIO2_IO10			0x00000021
				IMX8QM_ESAI1_TX3_RX2_LSIO_GPIO2_IO11			0x00000021
				IMX8QM_ESAI1_TX4_RX1_LSIO_GPIO2_IO12			0x00000021
				IMX8QM_ESAI1_TX5_RX0_LSIO_GPIO2_IO13			0x00000021
				IMX8QM_SPDIF0_RX_LSIO_GPIO2_IO14			0x00000021
				IMX8QM_SPDIF0_TX_LSIO_GPIO2_IO15			0x00000021
				IMX8QM_SPDIF0_EXT_CLK_LSIO_GPIO2_IO16			0x00000021
				IMX8QM_MLB_CLK_LSIO_GPIO3_IO27				0x00000021
				IMX8QM_MLB_SIG_LSIO_GPIO3_IO26				0x00000021
				IMX8QM_MLB_DATA_LSIO_GPIO3_IO28				0x00000021
				IMX8QM_SPI2_SCK_LSIO_GPIO3_IO07				0x00000021
				IMX8QM_SPI2_SDO_LSIO_GPIO3_IO08				0x00000021
				IMX8QM_SPI2_SDI_LSIO_GPIO3_IO09				0x00000021
				IMX8QM_SPI2_CS0_LSIO_GPIO3_IO10				0x00000021
			>;
		};
	};
};

&unused_gpios { /* GPIO: iWave Unused GPIO pins */
	gpios = <&lsio_gpio0 1 0>,
		<&lsio_gpio0 12 0>,
                <&lsio_gpio0 13 0>,
                <&lsio_gpio1 4 0>,
                <&lsio_gpio1 6 0>,
                <&lsio_gpio1 7 0>,
                <&lsio_gpio1 16 0>,
                <&lsio_gpio1 17 0>,
                <&lsio_gpio1 20 0>,
                <&lsio_gpio1 21 0>,
                <&lsio_gpio2 4 0>,
                <&lsio_gpio2 6 0>,
                <&lsio_gpio2 8 0>,
                <&lsio_gpio2 10 0>,
                <&lsio_gpio2 11 0>,
                <&lsio_gpio2 12 0>,
                <&lsio_gpio2 13 0>,
                <&lsio_gpio2 14 0>,
                <&lsio_gpio2 15 0>,
                <&lsio_gpio2 16 0>,
                <&lsio_gpio3 7 0>,
                <&lsio_gpio3 8 0>,
                <&lsio_gpio3 9 0>,
                <&lsio_gpio3 10 0>,
                <&lsio_gpio3 22 0>,
                <&lsio_gpio3 23 0>,
                <&lsio_gpio3 26 0>,
                <&lsio_gpio3 27 0>,
                <&lsio_gpio3 28 0>,
                <&lsio_gpio3 31 0>,
                <&lsio_gpio4 0 0>,
                <&lsio_gpio4 1 0>,
                <&lsio_gpio4 2 0>,
                <&lsio_gpio4 16 0>,
                <&lsio_gpio4 17 0>,
                <&lsio_gpio4 18 0>,
                <&lsio_gpio4 19 0>,
                <&lsio_gpio4 20 0>,
                <&lsio_gpio4 21 0>,
                <&lsio_gpio4 23 0>,
                <&lsio_gpio4 24 0>,
                <&lsio_gpio4 25 0>,
                <&lsio_gpio4 26 0>,
                <&lsio_gpio6 10 0>,
                <&lsio_gpio6 11 0>,
                <&lsio_gpio6 12 0>,
                <&lsio_gpio6 13 0>,
                <&lsio_gpio6 14 0>,
                <&lsio_gpio6 15 0>,
                <&lsio_gpio6 16 0>,
                <&lsio_gpio6 17 0>,
                <&lsio_gpio6 18 0>,
                <&lsio_gpio6 19 0>,
                <&lsio_gpio6 20 0>,
                <&lsio_gpio6 21 0>;
};

